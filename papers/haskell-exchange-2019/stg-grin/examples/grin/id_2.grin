-- eval is just an ordinary function

eval p =
  v <- fetch p
  case v of
    (Fid x.1) ->
      r.id <- id x.1
      update p r.id
      pure r.id

id x.0 =
  x.0' <- eval x.0
  pure x.0'
